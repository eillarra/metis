{% extends 'users/base.html' %}

{% load compress %}


{% block head_title %}Social accounts - {{ block.super }}{% endblock %}

{% block content %}
  <display-5>Account connections</display-5>

  {% if form.accounts %}
    <p>You can sign in to your account using any of the following third-party accounts:</p>

    <form method="post" action="{% url 'socialaccount_connections' %}">
      {% csrf_token %}
      <input type="hidden" name="account" v-model="account">
      <q-list class="row">
      {% for base_account in form.accounts %}
        {% with base_account.get_provider_account as account %}
          <q-item tag="label" v-ripple class="col-12 col-md">
            <q-item-section avatar>
              <q-radio v-model="account" val="{{ base_account.id }}"></q-radio>
            </q-item-section>
            <q-item-section>
              <q-item-label>{{ account.get_brand.name }}</q-item-label>
              <q-item-label caption>{{ account }}</q-item-label>
            </q-item-section>
          </q-item>
        {% endwith %}
      {% endfor %}
      </q-list>
      <q-btn outline color="red-12" type="submit" class="q-my-md" :disable="!account">Disconnect</q-btn>
    </form>
  {% else %}
    <p>You currently have no social network accounts connected to this account.</p>
  {% endif %}

  <q-separator class="q-my-lg"></q-separator>

  <display-5>Add a 3rd party account</display-5>
  {% include 'socialaccount/snippets/provider_list.html' with process='connect' %}
  {% include 'socialaccount/snippets/login_extra.html' %}
{% endblock %}

{% block scripts %}
{% compress js inline %}
  <script type="text/javascript">
    var app = Vue.createApp({
      data: function () {
        return {
          visibleDrawer: true,
          account: null
        };
      }
    });
    Metis.utils.registerComponents(app, [MetisCommonComponents]);
    app.use(Quasar);
    app.mount('#vue');
  </script>
{% endcompress %}
{% endblock %}
